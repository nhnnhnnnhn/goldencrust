<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Socket.IO Test</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <h2>ğŸ”Œ Socket.IO Test Client</h2>

  <button onclick="sendMessageFromUser()">ğŸ‘¤ User â†’ Employee</button>
  <button onclick="sendMessageFromEmployeeToUser()">ğŸ’¼ Employee â†’ User</button>
  <button onclick="sendMessageFromEmployeeToGuest()">ğŸ’¼ Employee â†’ Guest</button>
  <br><br>
  <button onclick="sendNotificationToUser()">ğŸ”” Notify User</button>
  <button onclick="sendNotificationToGuest()">ğŸ”” Notify Guest</button>

  <script>
    const socket = io('http://localhost:3000', {
      auth: {
        token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4MDg1OTNjZTZiZjA4ZGFiMmZjNDJhZSIsImlhdCI6MTc0Njg4NjQzNCwiZXhwIjoxNzQ2ODkwMDM0fQ.5kxPAH8BbYe9t7H3s_0LNu35S5BCxtr_5sBBN3SeIp8' // ğŸ”‘ Nhá»› thay báº±ng token há»£p lá»‡!
      }
    });

    socket.on('connect', () => {
      console.log("âœ… Connected:", socket.id);
    });

    socket.on('newMessage', (data) => {
      console.log("ğŸ“© Received message:", data);
    });

    socket.on('newEmployeeMessage', (data) => {
      console.log("ğŸ“© Received message from employee:", data);
    });

    socket.on('receiveNotification', (data) => {
      console.log("ğŸ”” Received notification:", data);
    });

    socket.on('messageSent', (data) => {
      console.log("âœ… Message sent confirmation:", data);
    });

    socket.on('errorMessage', (data) => {
      console.error("âŒ Error:", data.message);
    });

    socket.on('connect_error', (err) => {
      console.error("âŒ Connection error:", err.message);
    });

    // === Test functions ===

    function sendMessageFromUser() {
      socket.emit("sendMessageFromUser", {
        text: "ğŸ‘¤ Hello from user to employee!"
      });
    }

    function sendMessageFromEmployeeToUser() {
      socket.emit("sendMessageFromEmployeeToUser", {
        userId: "6808593ce6bf08dab2fc42ae",  // ğŸ†” ID ngÆ°á»i dÃ¹ng Ä‘ang online
        text: "ğŸ’¼ Hello from employee to user!"
      });
    }

    function sendMessageFromEmployeeToGuest() {
      socket.emit("sendMessageFromEmployee", {
        visitorId: "guest_1746888330739",  // ğŸ†” ID cá»§a guest (visitorId)
        text: "ğŸ’¼ Hello from employee to guest!"
      });
    }

    function sendNotificationToUser() {
      socket.emit("sendNotification", {
        recipientType: "user",
        recipient: "REPLACE_WITH_USER_ID", // ğŸ†” ID user nháº­n thÃ´ng bÃ¡o
        type: "custom",
        content: "ğŸ”” Notification for user",
        link: "/dashboard"
      });
    }

    function sendNotificationToGuest() {
      socket.emit("sendNotification", {
        recipientType: "guest",
        recipient: "guest_1746888330739", // ğŸ†” visitorId cá»§a guest
        type: "custom",
        content: "ğŸ”” Notification for guest"
      });
    }
  </script>
</body>
</html>
